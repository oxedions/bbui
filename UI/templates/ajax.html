<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Interroger un serveur web</title>

    <script>

// Exécute un appel AJAX GET
// Prend en paramètres l'URL cible et la fonction callback appelée en cas de succès
function ajaxGet(url, callback) {
    var req = new XMLHttpRequest();
    req.open("GET", url);
    req.addEventListener("load", function () {
        if (req.status >= 200 && req.status < 400) {
            // Appelle la fonction callback en lui passant la réponse de la requête
            callback(req.responseText);
        } else {
            console.error(req.status + " " + req.statusText + " " + url);
        }
    });
    req.addEventListener("error", function () {
        console.error("Network error with " + url);
    });
    req.send(null);
}

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function ajaxreloadGet(url, callback) {

    var req = new XMLHttpRequest();
    if ($req) {
      $req.onreadystatechange = function()
      {
          if (/4|^complete$/.test($req.readyState)) {
              document.getElementById('ReloadThis').innerHTML = $req.responseText;
              setTimeout(function(){$self($url,$callback);}, 1000);
          }
      };
      req.open("GET", url);
      req.addEventListener("load", function () {
          if (req.status >= 200 && req.status < 400) {
              // Appelle la fonction callback en lui passant la réponse de la requête
              callback(req.responseText);
          } else {
              console.error(req.status + " " + req.statusText + " " + url);
          }
      });
      req.addEventListener("error", function () {
          console.error("Network error with " + url);
      });
      req.send(null);
    }
}

function htmlwrite(reponse) {
    document.getElementById("demo").innerHTML = reponse;
}
</script>

</head>

<body>
    <h1>Quelques langages</h1>
    <ul id="langages">
    </ul>

<p id="demo">Click me to change my HTML content (innerHTML).</p>


<div>
    <script type="text/javascript">
for (let step = 0; step < 5; step++) {

ajaxGet("/coucou", htmlwrite);
}
</script>
coucou
</div>
</body>

</html>
